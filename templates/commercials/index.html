{% extends "base.html" %}
{% block content %}

  <section class="media-page commercials-page">
    <div class="collections-header">
      <div class="craft-spirits">
        <span class="dash">—</span> OUR COMMERCIALS <span class="dash">—</span>
      </div>

      <h1>Commercials</h1>
    </div>
    <div class="products-scroll" style="max-width:1200px; margin:0 auto; padding:0 20px;">
      {% if videos %}
      <div class="commercials-grid">
      {% for video in videos %}
        <div class="commercial-item">
          {% if video.video and video.video.name %}
            <div class="commercial-media">
              <div class="collection-card">
                <video controls preload="metadata" loop muted playsinline>
                  <source src="{{ video.video.url }}" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
              </div>
            </div>
            {% if video.title %}
              <h4 class="commercial-title">{{ video.title }}</h4>
            {% endif %}

          {% elif video.embed_html %}
            {% with emb=video.embed_html|lower %}
              {% if "example.com" not in emb %}
                <div class="commercial-media">
                  <div class="collection-card">
                    {{ video.embed_html|safe }}
                  </div>
                </div>
                {% if video.title %}
                  <h4 class="commercial-title">{{ video.title }}</h4>
                {% endif %}
              {% else %}
                {% if video.embed_url %}
                  <div class="commercial-media">
                    <div class="collection-card">
                      <div class="video-embed iframe-embed">
                        <iframe src="{{ video.embed_url }}" allowfullscreen loading="lazy"></iframe>
                      </div>
                    </div>
                  </div>
                  {% if video.title %}
                    <h4 class="commercial-title">{{ video.title }}</h4>
                  {% endif %}
                {% endif %}
              {% endif %}
            {% endwith %}

          {% elif video.embed_url %}
            <div class="commercial-media">
              <div class="collection-card">
                <div class="video-embed iframe-embed">
                  <iframe src="{{ video.embed_url }}" allowfullscreen loading="lazy"></iframe>
                </div>
              </div>
            </div>
            {% if video.title %}
              <h4 class="commercial-title">{{ video.title }}</h4>
            {% endif %}

          {% endif %}
        </div>
      {% endfor %}
      </div>
      {% else %}
        {# Fallback: render at least two local sample videos from repo media. Do not use external URLs. #}
        <div class="commercials-grid">
          <div class="commercial-item">
            <div class="commercial-item">
              <div class="commercial-media">
                <div class="collection-card">
                  <video controls preload="metadata" loop muted playsinline>
                    <source src="/media/commercials/videos/Blue_Black_and_Green_Minimalist_Modern_Customer_Success_Stories_Video_Message.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                  </video>
                </div>
              </div>
              {# fallback sample title for local preview #}
              <h4 class="commercial-title">Sample commercial</h4>
            </div>
          </div>

          <div class="commercial-item">
            <div class="commercial-item">
              <div class="commercial-media">
                <div class="collection-card">
                  <video controls preload="metadata" loop muted playsinline>
                    <source src="/media/commercials/videos/Blue_Black_and_Green_Minimalist_Modern_Customer_Success_Stories_Video_Message.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                  </video>
                </div>
              </div>
              {# fallback sample title for local preview #}
              <h4 class="commercial-title">Sample commercial</h4>
            </div>
          </div>
        </div>
      {% endif %}
    </div>
  </section>

{% endblock %}
